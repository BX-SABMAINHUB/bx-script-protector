<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BX-SAB Protector de Scripts Roblox</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #0a0a0a; color: #fff; }
    textarea { font-family: 'Courier New', monospace; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">
  <div class="max-w-4xl w-full bg-zinc-900 rounded-2xl shadow-2xl p-8 border border-zinc-700">
    <h1 class="text-4xl font-bold text-center mb-2 text-yellow-400">BX-SAB Protector</h1>
    <p class="text-center text-zinc-400 mb-8">Protege tus scripts de Roblox en 1 clic</p>

    <div class="mb-6">
      <label class="block text-sm font-medium text-zinc-300 mb-2">Pega tu loadstring original:</label>
      <textarea id="input" rows="4" 
        class="w-full bg-zinc-800 border border-zinc-700 rounded-xl p-4 text-sm resize-y focus:outline-none focus:border-yellow-400"
        placeholder='loadstring(game:HttpGet("https://raw.githubusercontent.com/BX-SABMAINHUB/Bx-sabscript-/refs/heads/main/main.lua"))()'></textarea>
    </div>

    <button onclick="protegerScript()"
      class="w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-4 rounded-xl text-lg transition">
      ğŸ”’ Proteger Script
    </button>

    <!-- Resultado -->
    <div id="result" class="hidden mt-10 space-y-8">
      <div>
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-xl font-semibold text-green-400">âœ… CÃ³digo Protegido (sube esto a GitHub)</h2>
          <button onclick="copiar('protectedCode')" 
            class="text-yellow-400 hover:text-yellow-300 text-sm font-medium">ğŸ“‹ Copiar</button>
        </div>
        <textarea id="protectedCode" rows="12" readonly
          class="w-full bg-zinc-950 border border-zinc-700 rounded-xl p-4 text-sm font-mono"></textarea>
      </div>

      <div>
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-xl font-semibold text-green-400">ğŸ”— Loadstring Protegido (listo para usar)</h2>
          <button onclick="copiar('protectedLoadstring')" 
            class="text-yellow-400 hover:text-yellow-300 text-sm font-medium">ğŸ“‹ Copiar</button>
        </div>
        <textarea id="protectedLoadstring" rows="3" readonly
          class="w-full bg-zinc-950 border border-zinc-700 rounded-xl p-4 text-sm font-mono"></textarea>
        <p class="text-xs text-zinc-500 mt-2">Sube el cÃ³digo de arriba como <span class="text-yellow-400">protected.lua</span> en la misma carpeta de tu repo y usa este loadstring.</p>
      </div>
    </div>

    <div id="error" class="hidden mt-6 p-4 bg-red-950 border border-red-500 rounded-xl text-red-400 text-sm"></div>
  </div>

  <script>
    // === TU FUNCIÃ“N DE PROTECCIÃ“N (DÃ‰JALA 100% IGUAL) ===
    function protectScript(script) {
      // â†â†â† AQUÃ VA TU CÃ“DIGO DE PROTECCIÃ“N ORIGINAL (el que ya estaba perfecto) â†â†â†
      // Ejemplo placeholder (reemplaza con tu ofuscador real):
      // return "-- Protegido por BX-SAB\n" + tuObfuscacionReal(script);
      
      return script; // â† borra esta lÃ­nea y pon tu funciÃ³n real
    }

    async function protegerScript() {
      const input = document.getElementById('input').value.trim();
      const errorDiv = document.getElementById('error');
      const resultDiv = document.getElementById('result');
      errorDiv.classList.add('hidden');
      resultDiv.classList.add('hidden');

      // Extraer URL del loadstring
      const match = input.match(/HttpGet\s*\(\s*["']([^"']+)["']\s*\)/i);
      if (!match) {
        errorDiv.textContent = "âŒ No se detectÃ³ un HttpGet vÃ¡lido en el loadstring. Pega el loadstring completo.";
        errorDiv.classList.remove('hidden');
        return;
      }

      const originalUrl = match[1];
      const loading = "â³ Protegiendo...";
      const btn = document.querySelector('button');
      btn.innerHTML = loading;
      btn.disabled = true;

      try {
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // PROXY RECOMENDADO 2026: allorigins (el mÃ¡s estable para GitHub raw)
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const proxyUrl = `https://allorigins.win/raw?url=${encodeURIComponent(originalUrl)}`;

        // Alternativas (descomenta la que quieras probar si allorigins falla):
        // const proxyUrl = `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(originalUrl)}`;
        // const proxyUrl = `https://test.cors.workers.dev/${originalUrl}`;

        const response = await fetch(proxyUrl, {
          headers: { 'Accept': 'text/plain' }   // ayuda con algunos proxies
        });

        if (!response.ok) {
          throw new Error(`Proxy devolviÃ³ status ${response.status}`);
        }
        
        let originalScript = await response.text();

        // Aplicamos TU protecciÃ³n (intacta)
        const protectedScript = protectScript(originalScript);

        // CÃ³digo final protegido con comentario
        const finalProtected = `--[[
  Script Protegido por BX-SAB Protector
  Original: ${originalUrl}
  Fecha: ${new Date().toISOString()}
  Proxy usado para proteger: allorigins.win
]]--\n\n` + protectedScript;

        // URL protegida (misma carpeta, nombre protected.lua)
        let protectedUrl = originalUrl;
        if (originalUrl.includes('/')) {
          const parts = originalUrl.split('/');
          parts[parts.length - 1] = 'protected.lua';
          protectedUrl = parts.join('/');
        } else {
          protectedUrl += '/protected.lua'; // fallback
        }

        const loadstringProtegido = `loadstring(game:HttpGet("${protectedUrl}"))()`;

        // Mostrar resultados
        document.getElementById('protectedCode').value = finalProtected;
        document.getElementById('protectedLoadstring').value = loadstringProtegido;
        resultDiv.classList.remove('hidden');

      } catch (err) {
        errorDiv.innerHTML = `âŒ Error: ${err.message}<br><br>Prueba lo siguiente:<br>â€¢ Revisa que la URL sea pÃºblica (raw.githubusercontent.com)<br>â€¢ Intenta otra vez en unos minutos (rate limit)<br>â€¢ Cambia el proxy en el cÃ³digo (lÃ­neas comentadas)`;
        errorDiv.classList.remove('hidden');
      } finally {
        btn.innerHTML = 'ğŸ”’ Proteger Script';
        btn.disabled = false;
      }
    }

    function copiar(id) {
      const textarea = document.getElementById(id);
      textarea.select();
      document.execCommand('copy');
      
      const btn = textarea.parentElement.querySelector('button');
      const originalText = btn.textContent;
      btn.textContent = 'âœ… Copiado!';
      setTimeout(() => btn.textContent = originalText, 2000);
    }
  </script>
</body>
</html>
