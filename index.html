<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BX-SAB Protector de Scripts Roblox</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #0a0a0a; color: #fff; }
    textarea { font-family: 'Courier New', monospace; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">
  <div class="max-w-4xl w-full bg-zinc-900 rounded-2xl shadow-2xl p-8 border border-zinc-700">
    <h1 class="text-4xl font-bold text-center mb-2 text-yellow-400">BX-SAB Protector</h1>
    <p class="text-center text-zinc-400 mb-8">Protege tus scripts de Roblox en 1 clic</p>

    <div class="mb-6">
      <label class="block text-sm font-medium text-zinc-300 mb-2">Pega tu loadstring original:</label>
      <textarea id="input" rows="4" 
        class="w-full bg-zinc-800 border border-zinc-700 rounded-xl p-4 text-sm resize-y focus:outline-none focus:border-yellow-400"
        placeholder='loadstring(game:HttpGet("https://raw.githubusercontent.com/BX-SABMAINHUB/Bx-sabscript-/refs/heads/main/main.lua"))()'></textarea>
    </div>

    <button onclick="protegerScript()"
      class="w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-4 rounded-xl text-lg transition">
      üîí Proteger Script
    </button>

    <!-- Resultado -->
    <div id="result" class="hidden mt-10 space-y-8">
      <div>
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-xl font-semibold text-green-400">‚úÖ C√≥digo Protegido (sube esto a GitHub)</h2>
          <button onclick="copiar('protectedCode')" 
            class="text-yellow-400 hover:text-yellow-300 text-sm font-medium">üìã Copiar</button>
        </div>
        <textarea id="protectedCode" rows="12" readonly
          class="w-full bg-zinc-950 border border-zinc-700 rounded-xl p-4 text-sm font-mono"></textarea>
      </div>

      <div>
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-xl font-semibold text-green-400">üîó Loadstring Protegido (listo para usar)</h2>
          <button onclick="copiar('protectedLoadstring')" 
            class="text-yellow-400 hover:text-yellow-300 text-sm font-medium">üìã Copiar</button>
        </div>
        <textarea id="protectedLoadstring" rows="3" readonly
          class="w-full bg-zinc-950 border border-zinc-700 rounded-xl p-4 text-sm font-mono"></textarea>
        <p class="text-xs text-zinc-500 mt-2">Sube el c√≥digo de arriba como <span class="text-yellow-400">protected.lua</span> en la misma carpeta de tu repo y usa este loadstring.</p>
      </div>
    </div>

    <div id="error" class="hidden mt-6 p-4 bg-red-950 border border-red-500 rounded-xl text-red-400 text-sm"></div>
  </div>

  <script>
    // === TU FUNCI√ìN DE PROTECCI√ìN (NO LA TOQUES) ===
    function protectScript(script) {
      // ‚Üê‚Üê‚Üê PEGA AQU√ç TU C√ìDIGO DE PROTECCI√ìN ORIGINAL ‚Üê‚Üê‚Üê
      // Por ahora placeholder:
      return script;
    }

    async function protegerScript() {
      const input = document.getElementById('input').value.trim();
      const errorDiv = document.getElementById('error');
      const resultDiv = document.getElementById('result');
      errorDiv.classList.add('hidden');
      resultDiv.classList.add('hidden');

      const match = input.match(/HttpGet\s*\(\s*["']([^"']+)["']\s*\)/i);
      if (!match) {
        errorDiv.textContent = "‚ùå No se detect√≥ un HttpGet v√°lido. Pega el loadstring completo.";
        errorDiv.classList.remove('hidden');
        return;
      }

      const originalUrl = match[1].trim();
      const btn = document.querySelector('button');
      btn.innerHTML = '‚è≥ Protegiendo...';
      btn.disabled = true;

      try {
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // PROXIES ACTUALIZADOS 2026 ‚Äì prueba en este orden
        // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const proxies = [
          // Opci√≥n 1 ‚Äì Cloudflare Worker (la m√°s estable ahora para GitHub raw)
          url => `https://test.cors.workers.dev/${url}`,

          // Opci√≥n 2 ‚Äì CodeTabs (simple y sigue vivo)
          url => `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`,

          // Opci√≥n 3 ‚Äì corsproxy.io (muy usado, pero a veces rate limit)
          url => `https://corsproxy.io/?${encodeURIComponent(url)}`,

          // Opci√≥n 4 ‚Äì allorigins (la anterior, como fallback)
          url => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`
        ];

        let originalScript = null;
        let usedProxy = '';

        for (const proxyFn of proxies) {
          try {
            const proxyUrl = proxyFn(originalUrl);
            usedProxy = proxyUrl.split('/')[2]; // solo para log

            const response = await fetch(proxyUrl, {
              headers: { 'Accept': 'text/plain,*/*' },
              redirect: 'follow'
            });

            if (response.ok) {
              originalScript = await response.text();
              break; // ¬°√âxito! salimos del loop
            }
            // Si no ok, probamos el siguiente proxy
          } catch (e) {
            // Error en este proxy ‚Üí siguiente
          }
        }

        if (!originalScript) {
          throw new Error('Ning√∫n proxy pudo descargar el script (todos fallaron)');
        }

        // Aplicamos TU protecci√≥n
        const protectedScript = protectScript(originalScript);

        const finalProtected = `--[[
  Script Protegido por BX-SAB Protector
  Original: ${originalUrl}
  Fecha: ${new Date().toISOString()}
  Proxy que funcion√≥: ${usedProxy}
]]--\n\n` + protectedScript;

        // Generar URL protegida
        let protectedUrl = originalUrl;
        if (originalUrl.includes('/')) {
          const parts = originalUrl.split('/');
          parts[parts.length - 1] = 'protected.lua';
          protectedUrl = parts.join('/');
        } else {
          protectedUrl = originalUrl.replace(/\/?$/, '') + '/protected.lua';
        }

        const loadstringProtegido = `loadstring(game:HttpGet("${protectedUrl}"))()`;

        document.getElementById('protectedCode').value = finalProtected;
        document.getElementById('protectedLoadstring').value = loadstringProtegido;
        resultDiv.classList.remove('hidden');

      } catch (err) {
        errorDiv.innerHTML = `‚ùå Error: ${err.message}<br><br>Pasos para solucionar:<br>‚Ä¢ Confirma que la URL original abre directamente en el navegador (debe mostrar c√≥digo Lua)<br>‚Ä¢ Prueba cambiar de proxy (edita el array "proxies" en el c√≥digo)<br>‚Ä¢ Espera 1-2 min y reintenta (rate limits)<br>‚Ä¢ Si es repo privado ‚Üí no funcionar√° (debe ser p√∫blico)`;
        errorDiv.classList.remove('hidden');
      } finally {
        btn.innerHTML = 'üîí Proteger Script';
        btn.disabled = false;
      }
    }

    function copiar(id) {
      const textarea = document.getElementById(id);
      textarea.select();
      document.execCommand('copy');
      const btn = event.target;
      const original = btn.textContent;
      btn.textContent = '‚úÖ Copiado!';
      setTimeout(() => btn.textContent = original, 1800);
    }
  </script>
</body>
</html>
